<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Registration - Antoniv University</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <meta name="description" content="Register as a new student at Antoniv University">
  <style>
    .register-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
    }

    .register-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      width: 100%;
      max-width: 600px;
      padding: 40px;
      position: relative;
      overflow: hidden;
    }

    .register-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(135deg, #667eea, #764ba2);
    }

    .register-header {
      text-align: center;
      margin-bottom: 40px;
    }

    .register-logo {
      font-size: 3rem;
      color: #667eea;
      margin-bottom: 15px;
    }

    .register-title {
      font-size: 2rem;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 8px;
    }

    .register-subtitle {
      color: #7f8c8d;
      font-size: 1rem;
      margin-bottom: 20px;
    }

    .progress-bar {
      background: #e9ecef;
      height: 4px;
      border-radius: 2px;
      margin-bottom: 30px;
      overflow: hidden;
    }

    .progress-fill {
      background: linear-gradient(135deg, #667eea, #764ba2);
      height: 100%;
      width: 0%;
      transition: width 0.3s ease;
    }

    .form-section {
      margin-bottom: 30px;
    }

    .section-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #495057;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-title i {
      color: #667eea;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 8px;
      font-size: 0.9rem;
    }

    .required {
      color: #dc3545;
    }

    .input-wrapper {
      position: relative;
    }

    .input-wrapper i {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #adb5bd;
      font-size: 1rem;
    }

    .form-input {
      width: 100%;
      padding: 12px 15px 12px 45px;
      border: 2px solid #e8ecef;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: #fff;
    }

    .form-input.no-icon {
      padding-left: 15px;
    }

    .form-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .form-input:focus + i {
      color: #667eea;
    }

    .course-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 10px;
    }

    .course-option {
      position: relative;
    }

    .course-option input[type="radio"] {
      position: absolute;
      opacity: 0;
    }

    .course-option label {
      display: block;
      padding: 15px;
      border: 2px solid #e8ecef;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      background: #fff;
    }

    .course-option input[type="radio"]:checked + label {
      border-color: #667eea;
      background: rgba(102, 126, 234, 0.1);
      color: #667eea;
    }

    .year-semester-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .terms-checkbox {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      margin: 25px 0;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 4px solid #667eea;
    }

    .terms-checkbox input[type="checkbox"] {
      margin-top: 2px;
      transform: scale(1.2);
      accent-color: #667eea;
    }

    .terms-checkbox label {
      font-size: 0.9rem;
      color: #495057;
      line-height: 1.5;
      margin: 0;
      font-weight: 400;
    }

    .terms-checkbox a {
      color: #667eea;
      text-decoration: none;
    }

    .terms-checkbox a:hover {
      text-decoration: underline;
    }

    .register-btn {
      width: 100%;
      padding: 15px;
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: 600;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 25px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .register-btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    }

    .register-btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }

    .login-link {
      text-align: center;
      padding-top: 25px;
      border-top: 1px solid #e8ecef;
      color: #6c757d;
    }

    .login-link a {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
      margin-left: 5px;
    }

    .login-link a:hover {
      text-decoration: underline;
    }

    .back-home {
      position: absolute;
      top: 20px;
      left: 20px;
    }

    .back-home a {
      display: flex;
      align-items: center;
      gap: 8px;
      color: rgba(255, 255, 255, 0.9);
      text-decoration: none;
      font-weight: 500;
      padding: 10px 15px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }

    .back-home a:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateX(-3px);
    }

    .loading-spinner {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    .success-message {
      text-align: center;
      padding: 40px;
    }

    .success-icon {
      font-size: 4rem;
      color: #28a745;
      margin-bottom: 20px;
    }

    .success-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 15px;
    }

    .student-id {
      font-size: 1.2rem;
      font-weight: 700;
      color: #667eea;
      background: rgba(102, 126, 234, 0.1);
      padding: 15px;
      border-radius: 10px;
      margin: 20px 0;
      border: 2px dashed #667eea;
    }

    .hidden {
      display: none;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @media (max-width: 768px) {
      .register-card {
        padding: 30px 25px;
        margin: 20px 10px;
      }

      .form-row,
      .year-semester-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .course-grid {
        grid-template-columns: 1fr;
      }

      .register-title {
        font-size: 1.6rem;
      }
    }

    @media (max-width: 480px) {
      .register-container {
        padding: 20px 10px;
      }
      
      .register-card {
        padding: 25px 20px;
      }
    }
  </style>
</head>
<body>
  <!-- Back to Home Button -->
  <div class="back-home">
    <a href="index.html">
      <i class="fas fa-arrow-left"></i>
      Back to Home
    </a>
  </div>

  <div class="register-container">
    <div class="register-card">
      <!-- Registration Form -->
      <div id="registrationForm" class="registration-form">
        <div class="register-header">
          <div class="register-logo">
            <i class="fas fa-user-plus"></i>
          </div>
          <h1 class="register-title">Join Antoniv University</h1>
          <p class="register-subtitle">Create your student account and start your journey</p>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar">
          <div class="progress-fill"></div>
        </div>

        <form id="studentRegisterForm" class="register-form">
          <!-- Personal Information -->
          <div class="form-section">
            <div class="section-title">
              <i class="fas fa-user"></i>
              Personal Information
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="firstName">First Name <span class="required">*</span></label>
                <div class="input-wrapper">
                  <input type="text" id="firstName" name="firstName" class="form-input" placeholder="Enter first name" required>
                  <i class="fas fa-user"></i>
                </div>
              </div>
              
              <div class="form-group">
                <label for="lastName">Last Name <span class="required">*</span></label>
                <div class="input-wrapper">
                  <input type="text" id="lastName" name="lastName" class="form-input" placeholder="Enter last name" required>
                  <i class="fas fa-user"></i>
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="email">Email Address <span class="required">*</span></label>
                <div class="input-wrapper">
                  <input type="email" id="email" name="email" class="form-input" placeholder="student@example.com" required>
                  <i class="fas fa-envelope"></i>
                </div>
              </div>
              
              <div class="form-group">
                <label for="phone">Phone Number <span class="required">*</span></label>
                <div class="input-wrapper">
                  <input type="tel" id="phone" name="phone" class="form-input" placeholder="10-digit mobile number" required>
                  <i class="fas fa-phone"></i>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="address">Address <span class="required">*</span></label>
              <div class="input-wrapper">
                <input type="text" id="address" name="address" class="form-input" placeholder="Enter your complete address" required>
                <i class="fas fa-map-marker-alt"></i>
              </div>
            </div>
          </div>

          <!-- Academic Information -->
          <div class="form-section">
            <div class="section-title">
              <i class="fas fa-graduation-cap"></i>
              Academic Information
            </div>

            <div class="form-group">
              <label>Select Course <span class="required">*</span></label>
              <div class="course-grid">
                <div class="course-option">
                  <input type="radio" id="cse" name="course" value="CSE" required>
                  <label for="cse">
                    <i class="fas fa-code"></i><br>
                    Computer Science<br>
                    <small>(CSE)</small>
                  </label>
                </div>
                <div class="course-option">
                  <input type="radio" id="it" name="course" value="IT" required>
                  <label for="it">
                    <i class="fas fa-network-wired"></i><br>
                    Information Technology<br>
                    <small>(IT)</small>
                  </label>
                </div>
                <div class="course-option">
                  <input type="radio" id="ce" name="course" value="CE" required>
                  <label for="ce">
                    <i class="fas fa-microchip"></i><br>
                    Computer Engineering<br>
                    <small>(CE)</small>
                  </label>
                </div>
              </div>
            </div>

            <div class="year-semester-grid">
              <div class="form-group">
                <label for="year">Academic Year <span class="required">*</span></label>
                <select id="year" name="year" class="form-input no-icon" required>
                  <option value="">Select Year</option>
                  <option value="1">First Year</option>
                  <option value="2">Second Year</option>
                  <option value="3">Third Year</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="semester">Current Semester <span class="required">*</span></label>
                <select id="semester" name="semester" class="form-input no-icon" required>
                  <option value="">Select Semester</option>
                  <option value="1">Semester 1</option>
                  <option value="2">Semester 2</option>
                  <option value="3">Semester 3</option>
                  <option value="4">Semester 4</option>
                  <option value="5">Semester 5</option>
                  <option value="6">Semester 6</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Account Security -->
          <div class="form-section">
            <div class="section-title">
              <i class="fas fa-lock"></i>
              Account Security
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="password">Password <span class="required">*</span></label>
                <div class="input-wrapper">
                  <input type="password" id="password" name="password" class="form-input" placeholder="Create strong password" required>
                  <i class="fas fa-lock"></i>
                </div>
              </div>
              
              <div class="form-group">
                <label for="confirmPassword">Confirm Password <span class="required">*</span></label>
                <div class="input-wrapper">
                  <input type="password" id="confirmPassword" name="confirmPassword" class="form-input" placeholder="Confirm your password" required>
                  <i class="fas fa-lock"></i>
                </div>
              </div>
            </div>
          </div>

          <!-- Terms and Conditions -->
          <div class="terms-checkbox">
            <input type="checkbox" id="terms" name="terms" required>
            <label for="terms">
              I agree to the <a href="#" onclick="showAlert('Terms and conditions would be displayed here', 'info')">Terms and Conditions</a> 
              and <a href="#" onclick="showAlert('Privacy policy would be displayed here', 'info')">Privacy Policy</a> 
              of Antoniv University. I understand that all information provided will be used for academic purposes.
            </label>
          </div>

          <button type="submit" class="register-btn" id="registerBtn">
            <i class="fas fa-user-plus"></i>
            Create Account
          </button>
        </form>

        <div class="login-link">
          Already have an account?
          <a href="login.html">Sign in here</a>
        </div>
      </div>

      <!-- Success Message (Hidden by default) -->
      <div id="successMessage" class="success-message hidden">
        <div class="success-icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <h2 class="success-title">Registration Successful!</h2>
        <p>Welcome to Antoniv University family!</p>
        <div class="student-id">
          Your Student ID: <span id="generatedStudentId"></span>
        </div>
        <p style="color: #6c757d; margin: 20px 0;">
          Please save your Student ID for future reference. You can now log in to access your student portal.
        </p>
        <a href="login.html" class="btn btn-primary">
          <i class="fas fa-sign-in-alt"></i>
          Go to Login
        </a>
      </div>
    </div>
  </div>

  <script src="js/main.js"></script>
  <script>
    // Registration form functionality
    const form = document.getElementById('studentRegisterForm');
    const progressFill = document.querySelector('.progress-fill');
    const registerBtn = document.getElementById('registerBtn');

    // Form progress calculation
    function updateProgress() {
      const inputs = form.querySelectorAll('input[required], select[required]');
      const filled = Array.from(inputs).filter(input => {
        if (input.type === 'radio') {
          return form.querySelector(`input[name="${input.name}"]:checked`);
        }
        return input.value.trim() !== '';
      });
      
      const progress = (filled.length / inputs.length) * 100;
      progressFill.style.width = progress + '%';
    }

    // Add event listeners to form fields
    form.addEventListener('input', updateProgress);
    form.addEventListener('change', updateProgress);

    // Phone number formatting
    document.getElementById('phone').addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length > 10) {
        value = value.slice(0, 10);
      }
      e.target.value = value;
    });

    // Password matching validation
    document.getElementById('confirmPassword').addEventListener('input', function() {
      const password = document.getElementById('password').value;
      const confirmPassword = this.value;
      
      if (confirmPassword && password !== confirmPassword) {
        this.setCustomValidity('Passwords do not match');
      } else {
        this.setCustomValidity('');
      }
    });

    // Year/Semester validation
    document.getElementById('year').addEventListener('change', function() {
      const year = parseInt(this.value);
      const semesterSelect = document.getElementById('semester');
      const semesterOptions = semesterSelect.querySelectorAll('option');
      
      // Reset semester selection
      semesterSelect.value = '';
      
      // Enable/disable semester options based on year
      semesterOptions.forEach(option => {
        if (option.value) {
          const semesterNum = parseInt(option.value);
          const maxSemester = year * 2;
          const minSemester = (year - 1) * 2 + 1;
          
          if (semesterNum >= minSemester && semesterNum <= maxSemester) {
            option.disabled = false;
            option.style.display = 'block';
          } else {
            option.disabled = true;
            option.style.display = 'none';
          }
        }
      });
    });

    // Form submission
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      // Get form data
      const formData = new FormData(form);
      const data = {
        name: `${formData.get('firstName')} ${formData.get('lastName')}`,
        email: formData.get('email'),
        phone: formData.get('phone'),
        address: formData.get('address'),
        course: formData.get('course'),
        year: parseInt(formData.get('year')),
        semester: parseInt(formData.get('semester')),
        password: formData.get('password')
      };
      
      // Validate passwords match
      if (formData.get('password') !== formData.get('confirmPassword')) {
        showAlert('Passwords do not match', 'error');
        return;
      }
      
      // Validate phone number
      if (!/^\d{10}$/.test(data.phone)) {
        showAlert('Please enter a valid 10-digit phone number', 'error');
        return;
      }
      
      // Set loading state
      setButtonLoading(registerBtn, true);
      
      try {
        // API call to register
        const response = await apiRequest('/auth/register', {
          method: 'POST',
          body: JSON.stringify(data)
        });
        
        if (response.user) {
          // Show success message
          document.getElementById('registrationForm').classList.add('hidden');
          document.getElementById('successMessage').classList.remove('hidden');
          document.getElementById('generatedStudentId').textContent = response.user.studentId;
          
          // Show success alert
          showAlert('Registration successful! Your student ID has been generated.', 'success');
        }
        
      } catch (error) {
        console.error('Registration error:', error);
        showAlert(error.message || 'Registration failed. Please try again.', 'error');
      } finally {
        setButtonLoading(registerBtn, false);
      }
    });

    // Initialize progress on page load
    document.addEventListener('DOMContentLoaded', function() {
      updateProgress();
      
      // Check if user is already logged in
      const currentUser = getCurrentUser();
      if (currentUser) {
        if (currentUser.role === 'admin') {
          window.location.href = 'admin/dashboard.html';
        } else {
          window.location.href = 'student/dashboard.html';
        }
      }
    });

    // Form field focus animations
    document.querySelectorAll('.form-input').forEach(input => {
      input.addEventListener('focus', function() {
        this.parentElement.style.transform = 'translateY(-2px)';
      });
      
      input.addEventListener('blur', function() {
        this.parentElement.style.transform = 'translateY(0)';
      });
    });
  </script>
</body>
</html>